# Telegram Bot –¥–ª—è –≤—ã–±–æ—Ä–∞ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ –æ –§–µ–≤—Ä–∞–ª—å—Å–∫–æ–π —Ä–µ–≤–æ–ª—é—Ü–∏–∏
# –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ –Ω–∞ Render.com

from telegram import Update, InlineKeyboardButton, InlineKeyboardMarkup
from telegram.ext import Application, CommandHandler, CallbackQueryHandler, ContextTypes
import logging
import os
from dotenv import load_dotenv

# –ó–∞–≥—Ä—É–∑–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
load_dotenv()

# –í–∫–ª—é—á–µ–Ω–∏–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
logging.basicConfig(
    format='%(asctime)s - %(name)s - %(levelname)s - %(message)s',
    level=logging.INFO
)
logger = logging.getLogger(__name__)

# –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö —Å –∞–≤—Ç–æ—Ä–∞–º–∏, –¥–∞—Ç–∞–º–∏ –∏ —Ç–µ–∫—Å—Ç–∞–º–∏
SOURCES = {
    "gippius": {
        "name": "–ì–∏–ø–ø–∏—É—Å –ó–∏–Ω–∞–∏–¥–∞ –ù–∏–∫–æ–ª–∞–µ–≤–Ω–∞",
        "about": "–ì–∏–ø–ø–∏—É—Å –ó–∏–Ω–∞–∏–¥–∞ –ù–∏–∫–æ–ª–∞–µ–≤–Ω–∞ (1869-1945). –ü–æ—ç—Ç–µ—Å—Å–∞ –∏ –ø–∏—Å–∞—Ç–µ–ª—å–Ω–∏—Ü–∞, –¥—Ä–∞–º–∞—Ç—É—Ä–≥ –∏ –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä–Ω—ã–π –∫—Ä–∏—Ç–∏–∫, –æ–¥–Ω–∞ –∏–∑ –≤–∏–¥–Ω—ã—Ö –ø—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç–µ–ª—å–Ω–∏—Ü ¬´–°–µ—Ä–µ–±—Ä—è–Ω–æ–≥–æ –≤–µ–∫–∞¬ª —Ä—É—Å—Å–∫–æ–π –∫—É–ª—å—Ç—É—Ä—ã.",
        "dates": {
            "25_feb": "–ö–∞—Ä—Ç–∞—à–æ–≤ —É–ø–æ—Ä–Ω–æ —Å—Ç–æ–∏—Ç –Ω–∞ —Ç–æ–º, —á—Ç–æ —ç—Ç–æ ¬´–±–∞–ª–µ—Ç¬ª, ‚Äî –∏ —Å—Ç—É–¥–µ–Ω—Ç—ã, –∏ –∫—Ä–∞—Å–Ω—ã–µ —Ñ–ª–∞–≥–∏, –∏ –≤–æ–µ–Ω–Ω—ã–µ –≥—Ä—É–∑–æ–≤–∏–∫–∏, –º–µ–¥–ª–µ–Ω–Ω–æ –¥–≤–∏–≥–∞—é—â–∏–µ—Å—è –ø–æ –ù–µ–≤—Å–∫–æ–º—É –∑–∞ —Ç–æ–ª–ø–æ–π (–Ω–µ—Ç –ø—Ä–æ–µ–∑–¥–∞), –≤ —Å—Ç—Ä–∞–Ω–Ω–æ–º –ø–æ–ª–æ–∂–µ–Ω–∏–∏ –∫–æ–Ω–≤–æ–∏—Ä—É—é—â–∏—Ö —ç—Ç–∏ –∫—Ä–∞—Å–Ω—ã–µ —Ñ–ª–∞–≥–∏.",
            "26_feb": "–ù–æ –ù–µ–≤—Å–∫–∏–π –æ—Ü–µ–ø–ª–µ–Ω. –ü–æ—è–≤–∏–ª–∏—Å—å ¬´—Å—Ç–∞—Ä—ã¬ª –∫–∞–∑–∞–∫–∏ <‚Ä¶>, —Ö–ª–µ—â–∞ –∂–µ–Ω—â–∏–Ω –∏ —Å—Ç—É–¥–µ–Ω—Ç–æ–≤. (–≠—Ç–æ —è –≤–∏–¥–µ–ª–∞ —Ç–∞–∫–∂–µ –∏ –∑–¥–µ—Å—å, –Ω–∞ –°–µ—Ä–≥–∏–µ–≤—Å–∫–æ–π, —Å–≤–æ–∏–º–∏ –≥–ª–∞–∑–∞–º–∏). <‚Ä¶>. –í–æ—Ç —Ç–µ, —Å—Ç—Ä–∞—à–Ω—ã–µ, –Ω–∞–ø–æ–ª–Ω—è—é—â–∏–µ —Å–µ–≥–æ–¥–Ω—è —Ç–µ–∞—Ç—Ä—ã –±–∏—Ç–∫–æ–º<‚Ä¶>. –í —ç—Ç–æ –∂–µ —Å–∞–º–æ–µ –≤—Ä–µ–º—è (–∑–Ω–∞—é –æ—Ç –æ—á–µ–≤–∏–¥—Ü–∞) —à–∞–ª—å–Ω–∞—è –ø—É–ª—è –∑–∞—Å—Ç–∏–≥–ª–∞ —Å—Ç—É–¥–µ–Ω—Ç–∞, –ø–æ–∫—É–ø–∞–≤—à–µ–≥–æ –±–∏–ª–µ—Ç —É –±–∞—Ä—ã—à–Ω–∏–∫–∞. –ò—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∞—è –∫–∞—Ä—Ç–∏–Ω–∞! –í—Å–µ —à–∫–æ–ª—ã, –≥–∏–º–Ω–∞–∑–∏–∏, –∫—É—Ä—Å—ã ‚Äî –∑–∞–∫—Ä—ã—Ç—ã. <‚Ä¶>. –°—Ç—É–¥–µ–Ω—Ç –∂–∏–≤–æ—Ç —Å–≤–æ–π –ø–æ–ª–æ–∂–∏–ª —Ä–∞–¥–∏ ¬´–∏—Å–∫—É—Å—Å—Ç–≤–∞¬ª...",
            "28_feb": "–ù. –°–ª–æ–Ω–∏–º—Å–∫–∏–π –ø—Ä–∏—à–µ–ª (—Å—Ç—É–¥–µ–Ω—Ç, –≤ –º—É–∑. –∫–æ–º–∞–Ω–¥–µ –ø—Ä–µ–æ–±—Ä–∞–∂–µ–Ω—Ü–µ–≤), –ø—Ä–∏–Ω–µ—Å –ª–∏—Å—Ç–∫–∏. –†–∞—Å—Å–∫–∞–∑—ã–≤–∞–ª –º–Ω–æ–≥–æ –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ–≥–æ. –°–∞–º –≤ —ç–∫—Å—Ç–∞–∑–µ, –∑–∞–±—ã–ª –≤–µ—Å—å —Å–≤–æ–π –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª–∏–∑–º.",
            "1_mar": "–í–µ—Ä–Ω—É–ª–∏—Å—å –¥–æ–º–æ–π —Å–æ –≤—Å—Ç—Ä–µ—Ç–∏–≤—à–∏–º—Å—è —Ç–∞–º –ú–∏—Ö. –ò–≤. –¢—É–≥–∞–Ω-–ë–∞—Ä–∞–Ω–æ–≤—Å–∫–∏–º. –ó–∞—Å—Ç–∞–ª–∏ —É–∂–µ –∫—É—á—É –Ω–∞—Ä–æ–¥–∞, —Å—Ç—É–¥–µ–Ω—Ç–æ–≤, –æ—Ñ–∏—Ü–µ—Ä–æ–≤ (—é–Ω—ã—Ö, —Ç–æ–∂–µ –Ω–µ–¥–∞–≤–Ω–∏—Ö —Å—Ç—É–¥–µ–Ω—Ç–æ–≤, –∫–æ–≥–¥–∞-—Ç–æ –∏–∑ –º–æ–µ–≥–æ ¬´–ó–æ–ª–æ—Ç–æ–≥–æ –ö–æ–ª—å—Ü–∞¬ª).",
            "2_mar": "–ß–µ—Ç–≤–µ—Ä–≥. –°–µ–≥–æ–¥–Ω—è —É—Ç—Ä–æ–º –≤—Å–µ –ø—Ä–∏—Ç–∞–π–Ω–æ, —Å—Ç—Ä–∞–Ω–Ω–æ —Ç–∏—Ö–æ. –ò –ø–æ–≥–æ–¥–∞ –≤–¥—Ä—É–≥ —Å–µ—Ä–æ–≤–∞—Ç–∞—è, —Ç–µ–º–Ω–∞—è. –ü—Ä–∏—à–ª–∏ –¥–≤–∞ –æ—Ñ–∏—Ü–µ—Ä–∞-–ø—Ä–∞–ø–æ—Ä—â–∏–∫–∞ (–±—ã–≤—à–∏–µ —Å—Ç—É–¥–µ–Ω—Ç—ã)."
        }
    },
    "paleolog": {
        "name": "–ü–∞–ª–µ–æ–ª–æ–≥ –ú–æ—Ä–∏—Å –ñ–æ—Ä–∂",
        "about": "–ü–∞–ª–µ–æ–ª–æ–≥ –ú–æ—Ä–∏—Å –ñ–æ—Ä–∂ (1859-1944). –§—Ä–∞–Ω—Ü—É–∑—Å–∫–∏–π –ø–æ–ª–∏—Ç–∏–∫, –¥–∏–ø–ª–æ–º–∞—Ç; —Å —è–Ω–≤–∞—Ä—è 1914 –≥–æ–¥–∞ —Ä–∞–±–æ—Ç–∞–ª –ø–æ—Å–ª–æ–º –§—Ä–∞–Ω—Ü–∏–∏ –≤ –†–æ—Å—Å–∏–∏. –ü–∏—Å–∞—Ç–µ–ª—å, –ø–æ–∂–∏–∑–Ω–µ–Ω–Ω—ã–π –ß–ª–µ–Ω –§—Ä–∞–Ω—Ü—É–∑—Å–∫–æ–π –∞–∫–∞–¥–µ–º–∏–∏.",
        "dates": {
            "28_feb": "–ù–æ –∫–æ–≥–¥–∞ –º—ã –≤—ã—Ö–æ–¥–∏–º –Ω–∞ –Ω–∞–±–µ—Ä–µ–∂–Ω—É—é, –Ω–∞—Å —É–∑–Ω–∞–µ—Ç –≥—Ä—É–ø–ø–∞ —Å—Ç—É–¥–µ–Ω—Ç–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –Ω–∞—Å –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤—É—é—Ç –∏ –ø—Ä–æ–≤–æ–∂–∞—é—Ç –Ω–∞—Å. <‚Ä¶>–ö –∫—Ä–∏–∫–∞–º ¬´–î–∞ –∑–¥—Ä–∞–≤—Å—Ç–≤—É–µ—Ç –§—Ä–∞–Ω—Ü–∏—è¬ª, ¬´–î–∞ –∑–¥—Ä–∞–≤—Å—Ç–≤—É–µ—Ç –ê–Ω–≥–ª–∏—è¬ª –Ω–µ–ø—Ä–∏—è—Ç–Ω–æ –ø—Ä–∏–º–µ—à–∏–≤–∞—é—Ç—Å—è –∫—Ä–∏–∫–∏: ¬´–î–∞ –∑–¥—Ä–∞–≤—Å—Ç–≤—É–µ—Ç –ò–Ω—Ç–µ—Ä–Ω–∞—Ü–∏–æ–Ω–∞–ª¬ª, ¬´–î–∞ –∑–¥—Ä–∞–≤—Å—Ç–≤—É–µ—Ç –º–∏—Ä¬ª.",
            "3_mar": "–ú–Ω–æ–≥–∏–µ –≤—Ä–∞—á–∏ –∏ –∞–ø—Ç–µ–∫–∞—Ä–∏ –ø—Ä–∏–æ–±—Ä–µ–ª–∏ –ø—Ä–∏–≤—ã—á–∫—É –≤–ø—Ä—ã—Å–∫–∏–≤–∞—Ç—å —Å–µ–±–µ –º–æ—Ä—Ñ–∏–π; —á–µ—Ä–µ–∑ –Ω–∏—Ö —É–ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ —ç—Ç–æ–≥–æ –ª–µ–∫–∞—Ä—Å—Ç–≤–∞ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–∏–ª–æ—Å—å —Å—Ä–µ–¥–∏ <‚Ä¶> —Å—Ç—É–¥–µ–Ω—Ç–æ–≤."
        }
    },
    "rostkovsky": {
        "name": "–†–æ—Å—Ç–∫–æ–≤—Å–∫–∏–π –§–µ–ª–∏–∫—Å –Ø–∫–æ–≤–ª–µ–≤–∏—á",
        "about": "–†–æ—Å—Ç–∫–æ–≤—Å–∫–∏–π –§–µ–ª–∏–∫—Å –Ø–∫–æ–≤–ª–µ–≤–∏—á (1841-1920). –í–æ–µ–Ω–Ω—ã–π –¥–µ—è—Ç–µ–ª—å, –≥–µ–Ω–µ—Ä–∞–ª –æ—Ç –∏–Ω—Ñ–∞–Ω—Ç–µ—Ä–∏–∏, —á–ª–µ–Ω –í–æ–µ–Ω–Ω–æ–≥–æ –°–æ–≤–µ—Ç–∞.",
        "dates": {
            "3_mar": "–ù–∞ –°–∞–¥–æ–≤–æ–π (–ø–æ —Ç—É —Å—Ç–æ—Ä–æ–Ω—É –ù–µ–≤—Å–∫–æ–≥–æ –∏ —á–µ—Ä–µ–∑ –ú–∞—Ä—Å–æ–≤–æ –ø–æ–ª–µ) –Ω–∞—Ä–æ–¥—É –º–µ–Ω—å—à–µ, —Ç–∏—à–µ –∏, –ø–æ-–≤–∏–¥–∏–º–æ–º—É, –±–æ–ª—å—à–µ –ø–æ—Ä—è–¥–∫—É. –í—Å—Ç—Ä–µ—á–∞–ª–∏—Å—å –Ω–µ–±–æ–ª—å—à–∏–µ (—á–µ–ª–æ–≤–µ–∫ –ø–æ 10‚Äì15) –ø—Ä–∞–≤–∏–ª—å–Ω–æ, —Å–ø–æ–∫–æ–π–Ω–æ —Å–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã –≥–æ—Ä–æ–¥—Å–∫–æ–π –º–∏–ª–∏—Ü–∏–∏ –ø–æ–¥ –∫–æ–º–∞–Ω–¥–æ—é —Å—Ç—É–¥–µ–Ω—Ç–æ–≤, –∏–º–µ—é—â–∏—Ö –±–µ–ª—ã–µ –ø–æ–≤—è–∑–∫–∏ –Ω–∞ –ª–µ–≤–æ–º —Ä—É–∫–∞–≤–µ (–ì[–æ—Ä–æ–¥—Å–∫–∞—è] –ú[–∏–ª–∏—Ü–∏—è] N)."
        }
    },
    "anonymous": {
        "name": "–ê–Ω–æ–Ω–∏–º—ã",
        "about": "–ü—Ä–µ–¥–ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ, –¥–Ω–µ–≤–Ω–∏–∫ –≤–µ–ª–∏ —Ç—Ä–∏ –¥–µ–≤–æ—á–∫–∏ –∫—É—Ä—Å–∏—Å—Ç–∫–∏ –ë–µ—Å—Ç—É–∂–µ–≤—Å–∫–∏—Ö –∫—É—Ä—Å–æ–≤ –≤ –ü–µ—Ç—Ä–æ–≥—Ä–∞–¥–µ. –î–Ω–µ–≤–Ω–∏–∫ –æ–ø–∏—Å—ã–≤–∞–µ—Ç —Å–æ–±—ã—Ç–∏—è 1916-1917 –≥–≥.",
        "dates": {
            "28_feb": "–£—Ç—Ä–æ–º –ø–æ—à–ª–∞ –ø–æ –æ–±—ã–∫–Ω–æ–≤–µ–Ω–∏—é –Ω–∞ –∫—É—Ä—Å—ã, —Ç–∞–º —Å—Ä–∞–∑—É –Ω–æ —Å–ª—É—á–∞–π–Ω–æ –ø–æ–ø–∞–ª–∞ –Ω–∞ —Å—Ö–æ–¥–∫—É. –í—ã—è—Å–Ω—è–ª–æ—Å—å –ø–æ–ª–æ–∂–µ–Ω–∏–µ –¥–µ–ª. –í–¥—Ä—É–≥ –ø–æ–ª—É—á–∞–µ—Ç—Å—è –∑–∞—è–≤–ª–µ–Ω–∏–µ, —á—Ç–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–∞ —Å–∞–Ω–∏—Ç–∞—Ä–Ω–∞—è –ø–æ–º–æ—â—å –≤–æ—Å—Å—Ç–∞–≤—à–∏–º, —Ç. –∫. —Å—Ä–µ–¥–∏ –Ω–∏—Ö –º–Ω–æ–≥–æ —Ä–∞–Ω–µ–Ω—ã—Ö –∏ –±–æ–ª—å–Ω—ã—Ö, –∏ —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç –∑–æ–≤–µ—Ç –≤—Å–µ—Ö –∫—É—Ä—Å–∏—Å—Ç–æ–∫ –Ω–∞ –ø–æ–º–æ—â—å, —á—Ç–æ–±—ã –æ—Ä–≥–∞–Ω–∏–∑–æ–≤–∞—Ç—å —Å–∞–Ω–∏—Ç–∞—Ä–Ω—ã–µ –¥—Ä—É–∂–∏–Ω—ã –∏ —Ç–µ–º –ø–æ–¥–∞—Ç—å –ø–æ—Å–∏–ª—å–Ω—É—é –ø–æ–º–æ—â—å. <‚Ä¶>–ü—Ä–∏–±–µ–∂–∞–ª –∫–∞–∫–æ–π-—Ç–æ —Å—Ç—É–¥–µ–Ω—Ç, –≥—Ä–æ–º–∫–æ –∑–∞—è–≤–∏–ª, —á—Ç–æ –æ–Ω –∏–∑ –¥—É–º—ã –∏ –ø—Ä–∏–≤–µ–∑ —Å–≤–µ–∂–∏–µ –Ω–æ–≤–æ—Å—Ç–∏. –°—Ç—É–¥–µ–Ω—Ç—ã –∏ –∫—É—Ä—Å–∏—Å—Ç–∫–∏ —Ç–µ—Å–Ω–æ–π —Ç–æ–ª–ø–æ–π –æ–∫—Ä—É–∂–∏–ª–∏ –µ–≥–æ. –†–∞–¥–æ—Å—Ç–Ω–æ–µ –∏–∑–≤–µ—Å—Ç–∏–µ –±—ã–ª–æ –ø–æ–∫—Ä—ã—Ç–æ –≥—Ä–æ–º–∫–∏–º–∏ –∫—Ä–∏–∫–∞–º–∏ ¬´–£—Ä–∞¬ª –∏ ¬´–î–∞ –∑–¥—Ä–∞–≤—Å—Ç–≤—É–µ—Ç –î–µ–º–æ–∫—Ä–∞—Ç–∏—á–µ—Å–∫–∞—è —Ä–µ—Å–ø—É–±–ª–∏–∫–∞¬ª."
        }
    },
    "menshov": {
        "name": "–ú–µ–Ω—å—à–æ–≤ –í–ª–∞–¥–∏–º–∏—Ä",
        "about": "–ú–µ–Ω—å—à–æ–≤ –í–ª–∞–¥–∏–º–∏—Ä (1891-–ø–æ—Å–ª–µ 1963). –ú–æ—Å–∫–≤–∏—á, –∏–Ω–∂–µ–Ω–µ—Ä –≤ –ú–æ—Å–∫–æ–≤—Å–∫–æ–º –ì—É–±—Å–æ–≤–¥–µ–ø–µ, –ì–≠–¢, –∑–∞—Ç–µ–º –Ω–∞ –≠–ª–µ–∫—Ç—Ä–æ–∑–∞–≤–æ–¥–µ, –ø–æ—Å–ª–µ –≤ –ì–ª–∞–≤–º–∞—à—Å—Ç—Ä–æ–µ.",
        "dates": {
            "27_feb": "–°—Ç—É–¥–µ–Ω—Ç—ã –∏ –æ–±—ã–≤–∞—Ç–µ–ª–∏ —Å–ø–æ–∫–æ–π–Ω–æ —Ä–∞—Å—Ö–∞–∂–∏–≤–∞—é—Ç –ø–æ —É–ª–∏—Ü–∞–º, –ø–æ—é—Ç —Ä–µ–≤–æ–ª—é—Ü–∏–æ–Ω–Ω—ã–µ –ø–µ—Å–Ω–∏ –∏ –≤—ã–∫—Ä–∏–∫–∏–≤–∞—é—Ç —Ä—É–∫–æ–≤–æ–¥—è—â–∏–µ –ª–æ–∑—É–Ω–≥–∏.<‚Ä¶> –ü–æ—Å–ª–µ —Å—Ö–æ–¥–∫–∏ –≤ –ò–Ω-—Ç–µ —Å—Ç—É–¥–µ–Ω—Ç—ã —Å–æ–±—Ä–∞–ª–∏—Å—å —É –ø–æ–¥—ä–µ–∑–¥–∞. –ü—Ä–æ–ø–µ–ª–∏ –≤–µ—á–Ω—É—é –ø–∞–º—è—Ç—å. –í–¥—Ä—É–≥ –æ—Ç–∫—É–¥–∞-—Ç–æ —è–≤–∏–ª—Å—è –ø—Ä–∏—Å—Ç–∞–≤. –Ø —É–≤–∏–¥–∞–ª –µ–≥–æ —Å—Ç–æ—è—â–∏–º —É —Å—Ç–µ–Ω—ã –ò–Ω-—Ç–∞, –ø—Ä–∏–∂–∞—Ç—ã–º —Å–æ –≤—Å–µ—Ö —Å—Ç–æ—Ä–æ–Ω —Å—Ç—É–¥–µ–Ω—Ç–∞–º–∏. –°—Ç—É–¥–µ–Ω—Ç—ã –≤—Å—Ç—É–ø–∞—é—Ç —Å –Ω–∏–º —Ä–∞–∑–≥–æ–≤–æ—Ä –∏ –æ–±—ä—è–≤–ª—è—é—Ç –µ–º—É, —á—Ç–æ –Ω–∞–∑–Ω–∞—á–µ–Ω–æ –Ω–æ–≤–æ–µ –ø—Ä–∞–≤–∏—Ç–µ–ª—å—Å—Ç–≤–æ. ¬´–ê –≥–¥–µ –∂–µ —Å—Ç–∞—Ä–æ–µ?¬ª ‚Äî —Å–ø—Ä–æ—Å–∏–ª —Ç–æ—Ç, —Ç–∞–∫–∏–º —Ä–∞—Å—Ç–µ—Ä—è–Ω–Ω—ã–º –∏ —É–ø–∞–≤—à–∏–º –≥–æ–ª–æ—Å–æ–º, —á—Ç–æ –≤—Å–µ–º —Å—Ç–∞–ª–æ –∂–∞–ª–∫–æ –µ–≥–æ. ¬´–°—Ç–∞—Ä–æ–µ –ø—Ä–∞–≤–∏—Ç–µ–ª—å—Å—Ç–≤–æ, –∫–∞–∫ –∏ –ø–æ–ª–∏—Ü–∏—è, –∏—Å—á–µ–∑–ª–æ¬ª, ‚Äî —Å–æ—Å—Ç—Ä–∏–ª –∫—Ç–æ-—Ç–æ –∏–∑ —Å—Ç—É–¥–µ–Ω—Ç–æ–≤. ¬´–ö—Ç–æ —Ç–∞–º? –ü—Ä–∏—Å—Ç–∞–≤? –ë–µ–π –µ–≥–æ! ‚Äî —Ä–∞–∑–¥–∞–ª–æ—Å—å —Å–∑–∞–¥–∏. ¬´–ó–∞—á–µ–º –±–∏—Ç—å? –ß—Ç–æ –≤—ã?! –î—É—Ä–∞–∫! ‚Äî –ø–æ—Å—ã–ø–∞–ª–∞—Å—å –Ω–∞ –∫—Ä–∏—á–∞–≤—à–µ–≥–æ. ¬´–û–±–µ–∑–æ—Ä—É–∂–∏—Ç—å –µ–≥–æ!¬ª ‚Äî –ù–æ –≤ –∫–æ–Ω—Ü–µ –∫–æ–Ω—Ü–æ–≤ –æ—Ç–ø—É—Å—Ç–∏–ª–∏ –ø—Ä–∏—Å—Ç–∞–≤–∞ —Ü–µ–ª—ã–º –∏ –Ω–µ–≤—Ä–µ–¥–∏–º—ã–º‚Ä¶.",
            "2_mar": "28 —Ñ–µ–≤—Ä–∞–ª—è –±—ã–ª –≤ –ì–æ—Å. –î—É–º–µ. –ù–∞ –õ–∏—Ç–µ–π–Ω–æ–º —Å—Ç–æ—è—Ç 2 —à–µ—Å—Ç–∏–¥—é–π–º[–æ–≤—ã–µ] –ø—É—à–∫–∏. –î—É–º—É –æ–∫—Ä—É–∂–∞–ª–∞ —Ç–æ–ª–ø–∞ —Å–æ–ª–¥–∞—Ç. –Ø, –∫–∞–∫ —Å—Ç—É–¥–µ–Ω—Ç, –ª–µ–≥–∫–æ –ø—Ä–æ–±—Ä–∞–ª—Å—è –≤–æ –¥–≤–æ—Ä–µ—Ü. –¢–∞–º –ø–æ–ª–Ω–µ–π—à–∏–π –±–µ—Å–ø–æ—Ä—è–¥–æ–∫. –°–æ–ª–¥–∞—Ç—ã –ø—Ä–∏—Ö–æ–¥—è—Ç, —É—Ö–æ–¥—è—Ç. –ü—Ä–∏–Ω–æ—Å—è—Ç —Ö–ª–µ–±, —Å–Ω–∞—Ä—è–¥—ã, –≤–∞–ª–µ–Ω—Ü—ã. –ü—Ä–∏–≤–æ–¥—è—Ç –∞—Ä–µ—Å—Ç–æ–≤–∞–Ω–Ω—ã—Ö. –ú–∞—Å—Å–∞–º–∏ –ø—Ä–∏–≤–æ–¥—è—Ç –ø–µ—Ä–µ–æ–¥–µ—Ç—ã—Ö –≥–æ—Ä–æ–¥–æ–≤—ã—Ö. –ü–æ–ø–∞–¥–∞—é—Ç—Å—è –æ—Ñ–∏—Ü–µ—Ä—ã, –≥–µ–Ω–µ—Ä–∞–ª—ã. –í—Å–µ—Ö –æ—Ç–≤–æ–¥—è—Ç –∫ –∫–∞–∫–æ–º—É —Ç–æ ¬´–∫–æ–º–µ–Ω–¥–∞–Ω—Ç—É¬ª.",
            "3_mar": "–°—Ç—É–¥–µ–Ω—Ç—ã –º–∏–ª–∏—Ü–∏–æ–Ω–µ—Ä—ã, –ø—Ä–∞–≤–¥–∞, –µ—â—ë –Ω–µ —Å–æ–≤—Å–µ–º –æ—Ä–≥–∞–Ω–∏–∑–æ–≤–∞–Ω–Ω—ã–µ, —Å—Ç—Ä–µ–º—è—Ç—Å—è –≤–æ–¥–≤–æ—Ä–∏—Ç—å –ø–æ—Ä—è–¥–æ–∫. –°–æ–ª–¥–∞—Ç—ã —Å–ª—É—à–∞—é—Ç—Å—è –∏—Ö. –í—á–µ—Ä–∞ —Ç–æ–ª–ø–∞ —Å–æ–ª–¥–∞—Ç –ø–æ—Ç—Ä–µ–±–æ–≤–∞–ª–∞ –≤—ã–¥–∞—á–∏ –∏–∑ –¢–µ—Ö–Ω[–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–≥–æ] –ò–Ω-—Ç–∞ –∞—Ä–µ—Å—Ç–æ–≤–∞–Ω–Ω–æ–≥–æ –ø–æ–ª–∫–æ–≤–Ω–∏–∫–∞. –ù–µ—Å–º–æ—Ç—Ä—è –Ω–∞ —É—Å–∏–ª–∏—è —Å—Ç—É–¥–µ–Ω—Ç–æ–≤, –ø–æ–ª–∫–æ–≤–Ω–∏–∫–∞ —É–±–∏–ª–∏ –ø–æ—á—Ç–∏ —É –º–µ–Ω—è –Ω–∞ –≥–ª–∞–∑–∞—Ö."
        }
    }
}

# –ü–µ—Ä–µ–≤–æ–¥ –¥–∞—Ç –Ω–∞ —Ä—É—Å—Å–∫–∏–π —è–∑—ã–∫
DATE_LABELS = {
    "25_feb": "25 —Ñ–µ–≤—Ä–∞–ª—è",
    "26_feb": "26 —Ñ–µ–≤—Ä–∞–ª—è",
    "27_feb": "27 —Ñ–µ–≤—Ä–∞–ª—è",
    "28_feb": "28 —Ñ–µ–≤—Ä–∞–ª—è",
    "1_mar": "1 –º–∞—Ä—Ç–∞",
    "2_mar": "2 –º–∞—Ä—Ç–∞",
    "3_mar": "3 –º–∞—Ä—Ç–∞"
}

async def start(update: Update, context: ContextTypes.DEFAULT_TYPE) -> None:
    """–°—Ç–∞—Ä—Ç–æ–≤–∞—è –∫–æ–º–∞–Ω–¥–∞ - –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –∞–≤—Ç–æ—Ä–æ–≤"""
    keyboard = []
    for author_key, author_data in SOURCES.items():
        keyboard.append([
            InlineKeyboardButton(
                author_data["name"],
                callback_data=f"author_{author_key}"
            )
        ])
    
    reply_markup = InlineKeyboardMarkup(keyboard)
    await update.message.reply_text(
        "üìö –í—ã–±–µ—Ä–∏—Ç–µ –∞–≤—Ç–æ—Ä–∞ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–æ–≥–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞ –æ –§–µ–≤—Ä–∞–ª—å—Å–∫–æ–π —Ä–µ–≤–æ–ª—é—Ü–∏–∏ 1917 –≥–æ–¥–∞:",
        reply_markup=reply_markup
    )

async def button_author(update: Update, context: ContextTypes.DEFAULT_TYPE) -> None:
    """–û–±—Ä–∞–±–æ—Ç—á–∏–∫ –≤—ã–±–æ—Ä–∞ –∞–≤—Ç–æ—Ä–∞"""
    query = update.callback_query
    await query.answer()
    
    author_key = query.data.split("_", 1)[1]
    author_data = SOURCES[author_key]
    
    keyboard = [
        [InlineKeyboardButton("üë§ –ö—Ç–æ —ç—Ç–æ?", callback_data=f"about_{author_key}")],
    ]
    
    # –î–æ–±–∞–≤–ª—è–µ–º –∫–Ω–æ–ø–∫–∏ —Å –¥–∞—Ç–∞–º–∏
    for date_key in author_data["dates"].keys():
        date_label = DATE_LABELS.get(date_key, date_key)
        keyboard.append([
            InlineKeyboardButton(date_label, callback_data=f"date_{author_key}_{date_key}")
        ])
    
    keyboard.append([InlineKeyboardButton("‚¨ÖÔ∏è –ù–∞–∑–∞–¥", callback_data="back_to_authors")])
    
    reply_markup = InlineKeyboardMarkup(keyboard)
    await query.edit_message_text(
        f"<b>{author_data['name']}</b>\n\n–í—ã–±–µ—Ä–∏—Ç–µ –¥–∞—Ç—É –∑–∞–ø–∏—Å–∏:",
        reply_markup=reply_markup,
        parse_mode="HTML"
    )

async def button_about(update: Update, context: ContextTypes.DEFAULT_TYPE) -> None:
    """–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ–± –∞–≤—Ç–æ—Ä–µ"""
    query = update.callback_query
    await query.answer()
    
    author_key = query.data.split("_", 1)[1]
    author_data = SOURCES[author_key]
    
    keyboard = [
        [InlineKeyboardButton("‚¨ÖÔ∏è –ù–∞–∑–∞–¥ –∫ –¥–∞—Ç–∞–º", callback_data=f"author_{author_key}")]
    ]
    
    reply_markup = InlineKeyboardMarkup(keyboard)
    await query.edit_message_text(
        f"<b>{author_data['name']}</b>\n\n{author_data['about']}",
        reply_markup=reply_markup,
        parse_mode="HTML"
    )

async def button_date(update: Update, context: ContextTypes.DEFAULT_TYPE) -> None:
    """–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ç–µ–∫—Å—Ç –∏—Å—Ç–æ—á–Ω–∏–∫–∞ –Ω–∞ –≤—ã–±—Ä–∞–Ω–Ω—É—é –¥–∞—Ç—É"""
    query = update.callback_query
    await query.answer()
    
    parts = query.data.split("_")
    author_key = parts[1]
    date_key = "_".join(parts[2:])
    
    author_data = SOURCES[author_key]
    date_label = DATE_LABELS.get(date_key, date_key)
    text = author_data["dates"][date_key]
    
    keyboard = [
        [InlineKeyboardButton("‚¨ÖÔ∏è –ù–∞–∑–∞–¥ –∫ –¥–∞—Ç–∞–º", callback_data=f"author_{author_key}")]
    ]
    
    reply_markup = InlineKeyboardMarkup(keyboard)
    await query.edit_message_text(
        f"<b>{author_data['name']}</b>\n<i>{date_label}</i>\n\n{text}",
        reply_markup=reply_markup,
        parse_mode="HTML"
    )

async def button_back(update: Update, context: ContextTypes.DEFAULT_TYPE) -> None:
    """–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∫ —Å–ø–∏—Å–∫—É –∞–≤—Ç–æ—Ä–æ–≤"""
    query = update.callback_query
    await query.answer()
    
    keyboard = []
    for author_key, author_data in SOURCES.items():
        keyboard.append([
            InlineKeyboardButton(
                author_data["name"],
                callback_data=f"author_{author_key}"
            )
        ])
    
    reply_markup = InlineKeyboardMarkup(keyboard)
    await query.edit_message_text(
        "üìö –í—ã–±–µ—Ä–∏—Ç–µ –∞–≤—Ç–æ—Ä–∞ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–æ–≥–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞ –æ –§–µ–≤—Ä–∞–ª—å—Å–∫–æ–π —Ä–µ–≤–æ–ª—é—Ü–∏–∏ 1917 –≥–æ–¥–∞:",
        reply_markup=reply_markup
    )

async def help_command(update: Update, context: ContextTypes.DEFAULT_TYPE) -> None:
    """–ö–æ–º–∞–Ω–¥–∞ –ø–æ–º–æ—â–∏"""
    help_text = """
üìö <b>–ü–æ–º–æ—â—å</b>

–≠—Ç–æ—Ç –±–æ—Ç –ø–æ–º–æ–≥–∞–µ—Ç –≤–∞–º –∏–∑—É—á–∞—Ç—å –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏ –æ –§–µ–≤—Ä–∞–ª—å—Å–∫–æ–π —Ä–µ–≤–æ–ª—é—Ü–∏–∏ 1917 –≥–æ–¥–∞.

<b>–î–æ—Å—Ç—É–ø–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã:</b>
/start - –ù–∞—á–∞—Ç—å —Ä–∞–±–æ—Ç—É —Å –±–æ—Ç–æ–º
/help - –ü–æ–∫–∞–∑–∞—Ç—å —ç—Ç—É —Å–ø—Ä–∞–≤–∫—É

<b>–ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:</b>
1. –í—ã–±–µ—Ä–∏—Ç–µ –∞–≤—Ç–æ—Ä–∞ –∏–∑ —Å–ø–∏—Å–∫–∞
2. –ù–∞–∂–º–∏—Ç–µ –Ω–∞ –∏–Ω—Ç–µ—Ä–µ—Å—É—é—â—É—é –≤–∞—Å –¥–∞—Ç—É
3. –ü—Ä–æ—á–∏—Ç–∞–π—Ç–µ –æ—Ç—Ä—ã–≤–æ–∫ –∏–∑ –∏—Å—Ç–æ—á–Ω–∏–∫–∞
4. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–Ω–æ–ø–∫–∏ –¥–ª—è –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
    """
    await update.message.reply_text(help_text, parse_mode="HTML")

async def error_handler(update: Update, context: ContextTypes.DEFAULT_TYPE) -> None:
    """–û–±—Ä–∞–±–æ—Ç—á–∏–∫ –æ—à–∏–±–æ–∫"""
    logger.error(msg="Exception while handling an update:", exc_info=context.error)

def main() -> None:
    """–ì–ª–∞–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –∑–∞–ø—É—Å–∫–∞ –±–æ—Ç–∞"""
    # –ü–æ–ª—É—á–∞–µ–º —Ç–æ–∫–µ–Ω –∏–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
    token = os.getenv("TELEGRAM_BOT_TOKEN")
    
    if not token:
        raise ValueError("TELEGRAM_BOT_TOKEN –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è")
    
    # –°–æ–∑–¥–∞–µ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
    application = Application.builder().token(token).build()
    
    # –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–æ–º–∞–Ω–¥
    application.add_handler(CommandHandler("start", start))
    application.add_handler(CommandHandler("help", help_command))
    
    # –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–Ω–æ–ø–æ–∫
    application.add_handler(CallbackQueryHandler(button_author, pattern="^author_"))
    application.add_handler(CallbackQueryHandler(button_about, pattern="^about_"))
    application.add_handler(CallbackQueryHandler(button_date, pattern="^date_"))
    application.add_handler(CallbackQueryHandler(button_back, pattern="^back_to_authors$"))
    
    # –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –æ—à–∏–±–æ–∫
    application.add_error_handler(error_handler)
    
    # –ó–∞–ø—É—Å–∫–∞–µ–º –±–æ—Ç–∞
    logger.info("–ë–æ—Ç –∑–∞–ø—É—â–µ–Ω...")
    application.run_polling(allowed_updates=Update.ALL_TYPES)

if __name__ == '__main__':
    main()
